FROM openjdk:11

ENV vertxver 3.8.0
ENV nettyver 4.1.19.Final
ENV groovyver 3.0.0-beta-3
ENV hazelcastver 3.12.4
ENV jacksonannotationsver 2.9.0
ENV jacksoncorever 2.9.0

COPY ${env.HOME}/.m2/repository/io/vertx/vertx-core/${vertxver}/vertx-core-${vertxver}.jar /aps-platform/dependencies
COPY ${env.HOME}/.m2/repository/io/vertx/vertx-web/${vertxver}/vertx-web-${vertxver}.jar /aps-platform/dependencies
COPY ${env.HOME}/.m2/repository/io/vertx/vertx-web-common/${vertxver}/vertx-web-common-${vertxver}.jar /aps-platform/dependencies
COPY ${env.HOME}/.m2/repository/io/vertx/vertx-hazelcast/${vertxver}/vertx-hazelcast-${vertxver}.jar /aps-platform/dependencies
COPY ${env.HOME}/.m2/repository/io/vertx/vertx-codegen/${vertxver}/vertx-codegen-${vertxver}.jar /aps-platform/dependencies
COPY ${env.HOME}/.m2/repository/io/vertx/vertx-health-check/${vertxver}/vertx-health-check-${vertxver}.jar /aps-platform/dependencies
COPY ${env.HOME}/.m2/repository/io/vertx/vertx-jdbc-client/${vertxver}/vertx-jdbc-client-${vertxver}.jar /aps-platform/dependencies
COPY ${env.HOME}/.m2/repository/io/vertx/vertx-lang.groovy/${vertxver}/vertx-lang-groovy-${vertxver}.jar /aps-platform/dependencies
COPY ${env.HOME}/.m2/repository/io/vertx/vertx-bridge-common/${vertxver}/vertx-bridge-common-${vertxver}.jar /aps-platform/dependencies
COPY ${env.HOME}/.m2/repository/io/vertx/vertx-amqp-bridge/${vertxver}/vertx-amqp-bridge-${vertxver}.jar /aps-platform/dependencies
COPY ${env.HOME}/.m2/repository/io/vertx/vertx-amqp-client/${vertxver}/vertx-amqp-client-${vertxver}.jar /aps-platform/dependencies
COPY ${env.HOME}/.m2/repository/io/vertx/vertx-auth-common/${vertxver}/vertx-auth-common-${vertxver}.jar /aps-platform/dependencies

COPY ${env.HOME}/.m2/repository/io/netty/netty-handler/${nettyver}/netty-handler-${nettyver}.jar /aps-platform/dependencies
COPY ${env.HOME}/.m2/repository/io/netty/netty-handler-proxy/${nettyver}/netty-handler-proxy-${nettyver}.jar /aps-platform/dependencies
COPY ${env.HOME}/.m2/repository/io/netty/netty-codec/${nettyver}/netty-codec-${nettyver}.jar /aps-platform/dependencies
COPY ${env.HOME}/.m2/repository/io/netty/netty-codec-socks/${nettyver}/netty-codec-socks-${nettyver}.jar /aps-platform/dependencies
COPY ${env.HOME}/.m2/repository/io/netty/netty-codec-http/${nettyver}/netty-codec-http-${nettyver}.jar /aps-platform/dependencies
COPY ${env.HOME}/.m2/repository/io/netty/netty-codec-http2/${nettyver}/netty-codec-http2-${nettyver}.jar /aps-platform/dependencies
COPY ${env.HOME}/.m2/repository/io/netty/netty-codec-dns/${nettyver}/netty-codec-dns-${nettyver}.jar /aps-platform/dependencies
COPY ${env.HOME}/.m2/repository/io/netty/netty-resolver/${nettyver}/netty-resolver-${nettyver}.jar /aps-platform/dependencies
COPY ${env.HOME}/.m2/repository/io/netty/netty-resolver-dns/${nettyver}/netty-resolver-dns-${nettyver}.jar /aps-platform/dependencies
COPY ${env.HOME}/.m2/repository/io/netty/netty-buffer/${nettyver}/netty-buffer-${nettyver}.jar /aps-platform/dependencies
COPY ${env.HOME}/.m2/repository/io/netty/netty-common/${nettyver}/netty-common-${nettyver}.jar /aps-platform/dependencies
COPY ${env.HOME}/.m2/repository/io/netty/netty-transport/${nettyver}/netty-transport-${nettyver}.jar /aps-platform/dependencies

COPY ${env.HOME}/.m2/repository/org/codehaus/groovy/groovy/${groovyver}/groovy-${groovyver}.jar /aps-platform/dependencies
COPY ${env.HOME}/.m2/repository/com/hazelcast/hazelcast/${hazelcastver}/hazelcast-${hazelcastver}.jar /aps-platform/dependencies
COPY ${env.HOME}/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/${jacksonannotationsver}/jackson-annotations-$jacksonannotationsver}.jar /aps-platform/dependencies
COPY ${env.HOME}/.m2/repository/com/fasterxml/jackson/core/jackson-core/${jacksoncorever}/jackson-core-$jacksoncorever}.jar /aps-platform/dependencies
COPY ${env.HOME}/.m2/repository/com/fasterxml/jackson/core/jackson-databind/${jacksoncorever}/jackson-databind-$jacksoncorever}.jar /aps-platform/dependencies

# Giving upp on this variant for now ...


# COPY imgsrc/aps-platform-deployment/bin/* /aps-platform/bin/
# COPY imgsrc/aps-platform-deployment/bundles/* /aps-platform/bundles/
# COPY imgsrc/aps-platform-deployment/dependencies/* /aps-platform/dependencies/
EXPOSE 8880/tcp
RUN /aps-platform/bin/run.sh
