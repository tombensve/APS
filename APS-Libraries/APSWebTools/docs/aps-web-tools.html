<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="generated-by" content="MarkdownDoc"/>
    <link href="docs.css" type="text/css" rel="stylesheet"/>
  </head>
  <body>
    <H1>APSWebTools</H1>
    <p>
      This is not an OSGi bundle! This is a plain jar containing utilities for web applications. Specifically APS administration web applications. This jar has to be included in each web application that wants to use it.      
    </p>
    <p>
      Among other things it provides support for being part of the APS administration web login (APSAdminWebLoginHandler). Since the APS administration web is built using Vaadin it has Vaadin support classes. APSVaadinOSGiApplication is a base class used by all APS administration webs.      
    </p>
    <H2>APIs</H2>
    <p>
      The following are the APIs for a few selected classes. The complete javadoc for this library can be found at <a href='http://apidoc.natusoft.se/APSWebTools/' title=''>http://apidoc.natusoft.se/APSWebTools/</a>.      
    </p>
    <hr/>    <p>
      public <em>class</em> <strong>APSAdminWebLoginHandler </strong> extends  APSLoginHandler  implements  APSLoginHandler.HandlerInfo    [se.natusoft.osgi.aps.tools.web] {      
    </p>
    <p>
      This is a login handler to use by any admin web registering with the <em>APSAdminWeb</em> to validate that there is a valid login available.      
    </p>
    <p>
            
    </p>
    <p>
      <strong>public APSAdminWebLoginHandler(BundleContext context)</strong>      
    </p>
    <p>
      Creates a new <em>APSAdminWebLoginHandler</em>.      
    </p>
    <p>
      <em>Parameters</em>      
    </p>
    <blockquote>
      <p>
        <em>context</em> - The bundle context.         
      </p>
    </blockquote>
    <p>
      <strong>public void setSessionIdFromRequestCookie(HttpServletRequest request)</strong>      
    </p>
    <p>
      Sets the session id from a cookie in the specified request.      
    </p>
    <p>
      <em>Parameters</em>      
    </p>
    <blockquote>
      <p>
        <em>request</em> - The request to get the session id cookie from.         
      </p>
    </blockquote>
    <p>
      <strong>public void saveSessionIdOnResponse(HttpServletResponse response)</strong>      
    </p>
    <p>
      Saves the current session id on the specified response.      
    </p>
    <p>
      <em>Parameters</em>      
    </p>
    <blockquote>
      <p>
        <em>response</em> - The response to save the session id cookie on.         
      </p>
    </blockquote>
    <p>
            
    </p>
    <p>
            
    </p>
    <p>
            
    </p>
    <p>
            
    </p>
    <p>
      }      
    </p>
    <hr/>    <p>
                
    </p>
    <p>
      public <em>class</em> <strong>APSLoginHandler </strong> implements  LoginHandler    [se.natusoft.osgi.aps.tools.web] {      
    </p>
    <p>
      This class validates if there is a valid logged in user and also provides a simple login if no valid logged in user exists.      
    </p>
    <p>
      This utility makes use of APSAuthService to login auth and APSSessionService for session handling. Trackers for these services are created internally which requires the shutdown() method to be called when no longer used to cleanup.      
    </p>
    <p>
      The bundle needs to import the following packages for this class to work:      
    </p>
    <pre>
      <code>
     se.natusoft.osgi.aps.api.auth.user;version="[0.9,2)",
     se.natusoft.osgi.aps.api.misc.session;version="[0.9,2)"
      </code>
    </pre>
    <p>
            
    </p>
    <p>
            
    </p>
    <p>
            
    </p>
    <p>
            
    </p>
    <p>
            
    </p>
    <p>
            
    </p>
    <p>
            
    </p>
    <p>
            
    </p>
    <p>
            
    </p>
    <p>
      <strong>public APSLoginHandler(BundleContext context, HandlerInfo handlerInfo)</strong>      
    </p>
    <p>
      Creates a new VaadinLoginDialogHandler.      
    </p>
    <p>
      <em>Parameters</em>      
    </p>
    <blockquote>
      <p>
        <em>context</em> - The bundles BundleContext.         
      </p>
    </blockquote>
    <p>
      <strong>protected void setHandlerInfo(HandlerInfo handlerInfo)</strong>      
    </p>
    <p>
      Sets the handler info when not provided in constructor.      
    </p>
    <p>
      <em>Parameters</em>      
    </p>
    <blockquote>
      <p>
        <em>handlerInfo</em> - The handler info to set.         
      </p>
    </blockquote>
    <p>
      <strong>public void shutdown()</strong>      
    </p>
    <p>
      Since this class internally creates and starts service trackers this method needs to be called on shutdown to cleanup!      
    </p>
    <p>
      <strong>public String getLoggedInUser()</strong>      
    </p>
    <p>
      This returns the currently logged in user or null if none are logged in.      
    </p>
    <p>
            
    </p>
    <p>
      <strong>public boolean hasValidLogin()</strong>      
    </p>
    <p>
      Returns true if this handler sits on a valid login.      
    </p>
    <p>
      <strong>public boolean login(String userId, String pw)</strong>      
    </p>
    <p>
      Logs in with a userid and a password.      
    </p>
    <p>
      This method does not use or modify any internal state of this object! It only uses the APSAuthService that this object sits on. This allows code sitting on an instance of this class to use this method for validating a user without having to setup its own service tracker for the <em>APSAuthService</em> when this object is already available due to the code also being an <em>APSAdminWeb</em> member. It is basically a convenience.      
    </p>
    <p>
      <em>Returns</em>      
    </p>
    <blockquote>
      <p>
        true if successfully logged in, false otherwise.        
      </p>
    </blockquote>
    <p>
      <em>Parameters</em>      
    </p>
    <blockquote>
      <p>
        <em>userId</em> - The id of the user to login.         
      </p>
    </blockquote>
    <blockquote>
      <p>
        <em>pw</em> - The password of the user to login.         
      </p>
    </blockquote>
    <p>
      <strong>public boolean login(String userId, String pw, String requiredRole)</strong>      
    </p>
    <p>
      Logs in with a userid and a password, and a required role.      
    </p>
    <p>
      This method does not use or modify any internal state of this object! It only uses the APSAuthService that this object sits on. This allows code sitting on an instance of this class to use this method for validating a user without having to setup its own service tracker for the <em>APSAuthService</em> when this object is already available due to the code also being an <em>APSAdminWeb</em> member. It is basically a convenience.      
    </p>
    <p>
      <em>Returns</em>      
    </p>
    <blockquote>
      <p>
        a valid User object on success or null on failure.        
      </p>
    </blockquote>
    <p>
      <em>Parameters</em>      
    </p>
    <blockquote>
      <p>
        <em>userId</em> - The id of the user to login.         
      </p>
    </blockquote>
    <blockquote>
      <p>
        <em>pw</em> - The password of the user to login.         
      </p>
    </blockquote>
    <blockquote>
      <p>
        <em>requiredRole</em> - If non null the user is required to have this role for a successful login. If it doesn't null will         
      </p>
    </blockquote>
    <p>
      public <em>static</em> <em>interface</em> <strong>HandlerInfo </strong>   [se.natusoft.osgi.aps.tools.web] {      
    </p>
    <p>
      Config values for the login handler.      
    </p>
    <p>
      <strong>String getSessionId()</strong>      
    </p>
    <p>
      <em>Returns</em>      
    </p>
    <blockquote>
      <p>
        An id to an APSSessionService session.        
      </p>
    </blockquote>
    <p>
      <strong>void setSessionId(String sessionId)</strong>      
    </p>
    <p>
      Sets a new session id.      
    </p>
    <p>
      <em>Parameters</em>      
    </p>
    <blockquote>
      <p>
        <em>sessionId</em> - The session id to set.         
      </p>
    </blockquote>
    <p>
      <strong>String getUserSessionName()</strong>      
    </p>
    <p>
      <em>Returns</em>      
    </p>
    <blockquote>
      <p>
        The name of the session data containing the logged in user if any.        
      </p>
    </blockquote>
    <p>
      <strong>String getRequiredRole()</strong>      
    </p>
    <p>
      <em>Returns</em>      
    </p>
    <blockquote>
      <p>
        The required role of the user for it to be considered logged in.        
      </p>
    </blockquote>
    <p>
      }      
    </p>
    <hr/>    <p>
                
    </p>
    <p>
      public <em>interface</em> <strong>LoginHandler </strong>   [se.natusoft.osgi.aps.tools.web] {      
    </p>
    <p>
      This is a simple API for doing a login.      
    </p>
    <p>
      <strong>public boolean hasValidLogin()</strong>      
    </p>
    <p>
      Returns true if this handler sits on a valid login.      
    </p>
    <p>
      <strong>boolean login(String userId, String pw)</strong>      
    </p>
    <p>
      Logs in with a userid and a password.      
    </p>
    <p>
      <em>Returns</em>      
    </p>
    <blockquote>
      <p>
        true if successfully logged in, false otherwise.        
      </p>
    </blockquote>
    <p>
      <em>Parameters</em>      
    </p>
    <blockquote>
      <p>
        <em>userId</em> - The id of the user to login.         
      </p>
    </blockquote>
    <blockquote>
      <p>
        <em>pw</em> - The password of the user to login.         
      </p>
    </blockquote>
    <p>
      <strong>public void shutdown()</strong>      
    </p>
    <p>
      If the handler creates service trackers or other things that needs to be shutdown when no longer used this method needs to be called when the handler is no longer needed.      
    </p>
    <p>
      }      
    </p>
    <hr/>    <p>
                
    </p>
  </body>
</html>
