<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="generated-by" content="MarkdownDoc"/>
    <link href="docs.css" type="text/css" rel="stylesheet"/>
  </head>
  <body>
    <H1>APSAuthService</H1>
    <p>
      This is a very simple little service that only does authentication of users. This service is currently used by the APS administration web (/apsadminweb) and APSExtProtocolHTTPTransportProvider for remote calls to services over http.      
    </p>
    <p>
      The idea behind this service is that it should be easy to provide an implementation of this that uses whatever authentication scheme you want/need. If you have an LDAP server you want to authenticate against for example, provide an implementation that looks up and authenticates the user against the LDAP server.      
    </p>
    <p>
      See this a little bit like an authentication plugin.      
    </p>
    <p>
      The APS web applications that use this only uses password authentication.      
    </p>
    <H2>APSSimpleUserServiceAuthServiceProvider</H2>
    <p>
      This provides an APSAuthService that uses the APSSimpleUserService to authenticate users. It only supports password authentication. If you don't have your own implementation of APSAuthService then you can deploy this one along with APSSimpleUserService, and probably APSUserAdminWeb.      
    </p>
    <p>
      <strong>Please note</strong> however that the standard implementation of APSSimpleUserService can register several instances with an "instance=name" property where name is unique for each instance, and each instance can reference a different data source. This is configured under <em>persistence/dsrefs</em> in the configuration. If no instances are configured an instance of "aps-admin-web" will be created by default. If instances are configured the default will not be created. And now the the point: APSSimpleuserServiceAuthServiceProvider will as of now track the "aps-admin-web" instance of APSSimpleUserService! If no such instance is configured it will fail after a timeout of not finding a service!      
    </p>
    <H2>API</H2>
    <p>
      public <em>interface</em> <strong>APSAuthService&lt;Credential&gt; </strong>   [se.natusoft.osgi.aps.api.auth.user] {      
    </p>
    <p>
      This is intended to be used as a wrapper to other means of authentication. Things in APS that needs authentication uses this service.      
    </p>
    <p>
      Implementations can lookup the user in an LDAP for example, or use some other user service.      
    </p>
    <p>
      APS supplies an <em>APSSimpleUserServiceAuthServiceProvider</em> that uses the <em>APSSimpleUserService</em> to authenticate. It is provided in its own bundle.      
    </p>
    <p>
      <strong>Properties authUser(String userId, Credential credentials, AuthMethod authMethod) throws APSAuthMethodNotSupportedException</strong>      
    </p>
    <p>
      This authenticates a user. A Properties object is returned on successful authentication. null is returned on failure. The Properties object returned contains misc information about the user. It can contain anything or nothing at all. There can be no assumptions about its contents!      
    </p>
    <p>
      <em>Returns</em>      
    </p>
    <blockquote>
      <p>
        User properties on success, null on failure.        
      </p>
    </blockquote>
    <p>
      <em>Parameters</em>      
    </p>
    <blockquote>
      <p>
        <em>userId</em> - The id of the user to authenticate.         
      </p>
    </blockquote>
    <blockquote>
      <p>
        <em>credentials</em> - What this is depends on the value of AuthMethod. It is up to the service implementation to resolve this.         
      </p>
    </blockquote>
    <blockquote>
      <p>
        <em>authMethod</em> - This hints at how to interpret the credentials.         
      </p>
    </blockquote>
    <p>
      <em>Throws</em>      
    </p>
    <blockquote>
      <p>
        <em>APSAuthMethodNotSupportedException</em> - If the specified authMethod is not supported by the implementation.         
      </p>
    </blockquote>
    <p>
      <strong>Properties authUser(String userId, Credential credentials, AuthMethod authMethod, String role) throws APSAuthMethodNotSupportedException</strong>      
    </p>
    <p>
      This authenticates a user. A Properties object is returned on successful authentication. <em>null</em> is returned on failure. The Properties object returned contains misc information about the user. It can contain anything or nothing at all. There can be no assumptions about its contents!      
    </p>
    <p>
      <em>Returns</em>      
    </p>
    <blockquote>
      <p>
        User properties on success, null on failure.        
      </p>
    </blockquote>
    <p>
      <em>Parameters</em>      
    </p>
    <blockquote>
      <p>
        <em>userId</em> - The id of the user to authenticate.         
      </p>
    </blockquote>
    <blockquote>
      <p>
        <em>credentials</em> - What this is depends on the value of AuthMethod. It is up to the service implementation to resolve this.         
      </p>
    </blockquote>
    <blockquote>
      <p>
        <em>authMethod</em> - This hints at how to interpret the credentials.         
      </p>
    </blockquote>
    <blockquote>
      <p>
        <em>role</em> - The specified user must have this role for authentication to succeed. Please note that the APS admin webs will pass "apsadmin" for the role. The implementation might need to translate this to another role.         
      </p>
    </blockquote>
    <p>
      <em>Throws</em>      
    </p>
    <blockquote>
      <p>
        <em>APSAuthMethodNotSupportedException</em> - If the specified authMethod is not supported by the implementation.         
      </p>
    </blockquote>
    <p>
      <strong>AuthMethod[] getSupportedAuthMethods()</strong>      
    </p>
    <p>
      Returns an array of the AuthMethods supported by the implementation.      
    </p>
    <p>
      public <em>static</em> <em>enum</em> <strong>AuthMethod </strong>   [se.natusoft.osgi.aps.api.auth.user] {      
    </p>
    <p>
      This hints at how to use the credentials.      
    </p>
    <p>
      <strong>NONE</strong>      
    </p>
    <p>
       Only userid is required.      
    </p>
    <p>
      <strong>PASSWORD</strong>      
    </p>
    <p>
       toString() on the credentials object should return a password.      
    </p>
    <p>
      <strong>KEY</strong>      
    </p>
    <p>
       The credential object is a key of some sort.      
    </p>
    <p>
      <strong>CERTIFICATE</strong>      
    </p>
    <p>
       The credential object is a certificate of some sort.      
    </p>
    <p>
      <strong>DIGEST</strong>      
    </p>
    <p>
       The credential object is a digest password.      
    </p>
    <p>
      <strong>SSO</strong>      
    </p>
    <p>
       The credential object contains information for participating in a single sign on.      
    </p>
    <p>
      }      
    </p>
    <hr/>    <p>
                
    </p>
  </body>
</html>
