<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="generated-by" content="MarkdownDoc"/>
    <link href="docs.css" type="text/css" rel="stylesheet"/>
  </head>
  <body>
    <H1>APSTCPIPService</H1>
    <p>
      This service provides, in ways of communication, plain simple TCP/IP communication. Users of this service will however have very little contact with the java.net classes.      
    </p>
    <p>
      The following are the points of this service:      
    </p>
    <ul>
      <li>
        <p>
          Simple TCP/IP usage.          
        </p>
      </li>
      <li>
        <p>
          Makes use of an URI to provide what I call a "connection point". tcp:, udp:, and multicast: are supported protocols.          
        </p>
      </li>
    </ul>
    <p>
      Do note that you do need to have a basic understanding of TCP/IP to use this service!      
    </p>
    <H2>Security</H2>
    <p>
      Makes use of 2 separate services if available for security: <em>APSTCPSecurityService</em> and <em>APSUDPSecurityService</em>. Neither these nor APSTCPIPService makes any assumptions nor demands on the what and how of the security services implementations. The APSTCPSecurityService must provide secure versions of Socket and ServerSocket, while APSUDPSecureService have 2 methods, one to encrypt the data and one to decrypt the data in a DatagramPacket.      
    </p>
    <p>
      APS currently does not provide any implementation of the APS(TCP/UDP)SecurityService.      
    </p>
    <H2>Connection Point URIs</H2>
    <p>
      The service makes use of URIs to specify where to connect for sending or receiving.      
    </p>
    <p>
      The URI format is this:      
    </p>
    <p>
      &nbsp; &nbsp; &nbsp; &nbsp;<strong>protocol://host:port#fragment,fragment</strong>      
    </p>
    <p>
      Protocols:      
    </p>
    <p>
      &nbsp; &nbsp; &nbsp; &nbsp;<strong>tcp</strong>,<strong> udp</strong>,<strong> multicast</strong>,<strong> named</strong>      
    </p>
    <p>
      The <em>named</em> protocol just provides a name for the <em>host</em> part of the URI. This is not however a hostname! It is a name that has been entered in the service configuration and which has an URI value which will be used instead. So<em> named://mysvc</em> will lookup a config value having "mysvc" as destination name and use its destination URI as connection URI. So the valid URI protocols in the configuration is then tcp, udp, and multicast.      
    </p>
    <p>
      Fragments:      
    </p>
    <p>
      &nbsp; &nbsp; &nbsp; &nbsp;<strong>secure</strong> - If specified then one of the APS(TCP/UDP)SecurityService services will be used.      
    </p>
    <p>
      &nbsp; &nbsp; &nbsp; &nbsp;<strong>async</strong> (only valid on <em>tcp</em> protocol)      
    </p>
    <H2>Examples</H2>
    <H3>TCP</H3>
    <H4>Write</H4>
    <pre>
      <code>
    APSTCPIPService tcpipSvc;
    ...
    tcpipSvc.sendStreamedRequest(new URI("tcp://localhost:9999"), new StreamedRequest() {
        void sendRequest(URI connectionPoint, OutputStream requestStream, InputStream responseStream) throws IOException {
            // write to requestStream ...
    
            // read from response stream ...
        }
    })
      </code>
    </pre>
    <H4>Read</H4>
    <pre>
      <code>
    APSTCPIPService tcpipSvc;
    ...
    tcpipSvc.setStreamedRequestListener(new URI("tcp://localhost:9999"), this);
    ...
    void requestReceived(URI receivePoint, InputStream requestStream, OutputStream responseStream) {
        // Read request from reqStream ...
    
        // Write response to respStream ...
    }
      </code>
    </pre>
    <p>
      Note that there can only be one listener per URI.      
    </p>
    <H3>UDP / Multicast</H3>
    <p>
      Since Multicast uses UDP packets there is no difference between host and port connected UDP or Multicast. The only difference is in the URI where "udp://" is specified for UDP packets and "multicast://" is specified for multicast packets.      
    </p>
    <H4>Write</H4>
    <pre>
      <code>
    APSTCPIPService tcpipSvc;
    ...
    bytes[] bytes = "Some data".getBytes();
    tcpipSvc.sendDataPacket(new URI("udp://localhost:9999"),  bytes);
      </code>
    </pre>
    <p>
      or      
    </p>
    <pre>
      <code>
    tcpipSvc.sendDataPacket(new URI("multicast://all-systems.mcast.net:9999"), bytes);
      </code>
    </pre>
    <H4>READ</H4>
    <pre>
      <code>
    APSTCPIPService tcpipSvc;
    ...
    tcpipSvc.addDataPacketListener(new URI("udp://localhost:9999"), this);
    ...
    void dataBlockReceived(URI receivePoint, DatagramPacket packet) {
        byte[] bytes = packet.getData();
        ...
    }
      </code>
    </pre>
  </body>
</html>
