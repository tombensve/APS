<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="generated-by" content="MarkdownDoc"/>
    <link href="docs.css" type="text/css" rel="stylesheet"/>
  </head>
  <body>
    <H1>APS RabbitMQ Message Service Provider</H1>
    <p>
      This service provides an implementation of APSMessageService using <a href='http://www.rabbitmq.com/' title=''>RabbitMQ</a>.      
    </p>
    <H2>APSMessageService API</H2>
    <p>
      <a href='http://apidoc.natusoft.se/APS/se/natusoft/osgi/aps/api/net/messaging/service/APSMessageService.html' title=''>Javadoc</a>      
    </p>
    <p>
      public <em>interface</em> <strong>APSClusterService </strong> extends  APSMessageService    [se.natusoft.osgi.aps.api.net.messaging.service] {      
    </p>
    <p>
      All of APSMessageService, APSSynchronizedMapService, and APSSyncService are part of some cluster which they communicate with. This represents that cluster in a general form.      
    </p>
    <p>
      Since APSClusterService extends APSMessageService both are provided by the same bundle. The sync services can also be part of the same bundle, but can also be implemented on top of APSMessageService.      
    </p>
    <p>
      <strong>String getName()</strong>      
    </p>
    <p>
      Returns the name of the cluster.      
    </p>
    <p>
      <strong>boolean isMasterNode()</strong>      
    </p>
    <p>
      If the implementation has the notion of a master and this node is the master then true is returned. In all other cases false is returned.      
    </p>
    <p>
      <strong>APSCommonDateTime getCommonDateTime()</strong>      
    </p>
    <p>
      Returns the network common DateTime that is independent of local machine times.      
    </p>
    <p>
      }      
    </p>
    <hr/>    <p>
                
    </p>
    <p>
      public <em>interface</em> <strong>APSMessageService </strong>   [se.natusoft.osgi.aps.api.net.messaging.service] {      
    </p>
    <p>
      This defines a simple message service. Can be implemented by using a message bus like RabbitMQ, Active MQ, etc or just a simple tcpip server or whatever.      
    </p>
    <p>
      Since the actual members are outside of this service API, it doesn't really know who they are and doesn't care, all members are defined by configuration to make a cluster of members.      
    </p>
    <p>
      <strong>public static final String APS_MESSAGE_SERVICE_PROVIDER = "aps-message-service-provider"</strong>      
    </p>
    <p>
      Multiple providers of this service can be deployed at the same time. Using this property when registering services for a provider allows clients to lookup a specific provider.      
    </p>
    <p>
      <strong>public static final String APS_MESSAGE_SERVICE_INSTANCE_NAME = "aps-message-service-instance-name"</strong>      
    </p>
    <p>
      Each configured instance of this service should have this property with a unique instance name so that client can lookup a specific instance of the service.      
    </p>
    <p>
      <strong>void addMessageListener(APSMessageListener listener)</strong>      
    </p>
    <p>
      Adds a listener for types.      
    </p>
    <p>
      <em>Parameters</em>      
    </p>
    <blockquote>
      <p>
        <em>listener</em> - The listener to add.         
      </p>
    </blockquote>
    <p>
      <strong>void removeMessageListener(APSMessageListener listener)</strong>      
    </p>
    <p>
      Removes a messaging listener.      
    </p>
    <p>
      <em>Parameters</em>      
    </p>
    <blockquote>
      <p>
        <em>listener</em> - The listener to remove.         
      </p>
    </blockquote>
    <p>
      <strong>void sendMessage(APSMessage message) throws APSMessagingException</strong>      
    </p>
    <p>
      Sends a message.      
    </p>
    <p>
      <em>Parameters</em>      
    </p>
    <blockquote>
      <p>
        <em>message</em> - The message to send.         
      </p>
    </blockquote>
    <p>
      <em>Throws</em>      
    </p>
    <blockquote>
      <p>
        <em>se.natusoft.osgi.aps.api.net.messaging.exception.APSMessagingException</em> - on failure.         
      </p>
    </blockquote>
    <p>
      public <em>static</em> <em>abstract</em> <em>class</em> <strong>AbstractMessageServiceProvider </strong> implements  APSMessageService    [se.natusoft.osgi.aps.api.net.messaging.service] {      
    </p>
    <p>
      Provides an abstract implementation of the APSMessageService interface.      
    </p>
    <p>
            
    </p>
    <p>
            
    </p>
    <p>
            
    </p>
    <p>
      <strong>protected void sendToListeners(APSMessage message)</strong>      
    </p>
    <p>
      Sends a message to the registered listeners.      
    </p>
    <p>
      <em>Parameters</em>      
    </p>
    <blockquote>
      <p>
        <em>message</em> - The message to send.         
      </p>
    </blockquote>
    <p>
      }      
    </p>
    <hr/>    <p>
                
    </p>
    <p>
      public <em>interface</em> <strong>APSSynchronizedMapService </strong>   [se.natusoft.osgi.aps.api.net.messaging.service] {      
    </p>
    <p>
      This service makes a synchronized named map available.      
    </p>
    <p>
      <strong>Map&lt;String, String&gt; getNamedMap(String name)</strong>      
    </p>
    <p>
      Returns a named map into which objects can be stored with a name.      
    </p>
    <p>
      If the named map does not exists it should be created and an empty map be returned.      
    </p>
    <p>
      <strong>List&lt;String&gt; getAvailableNamedMaps()</strong>      
    </p>
    <p>
      Returns the available names.      
    </p>
    <p>
      <strong>boolean supportsNamedMapPersistence()</strong>      
    </p>
    <p>
      Returns true if the implementation supports persistence for stored objects. If false is returned objects are in memory only.      
    </p>
    <p>
      }      
    </p>
    <hr/>    <p>
                
    </p>
    <p>
      public <em>interface</em> <strong>APSSyncService </strong>   [se.natusoft.osgi.aps.api.net.messaging.service] {      
    </p>
    <p>
      This defines a data synchronization service.      
    </p>
    <p>
      <strong>public static final String SYNC_PROVIDER = "aps-sync-provider"</strong>      
    </p>
    <p>
      A property key that should be registered with each service instance to indicate the specific implementation of the service. This to allow multiple implementations to be deployed and clients can ask for a specific if needed.      
    </p>
    <p>
      <strong>public static final String SYNC_INSTANCE_NAME = "aps-sync-instance-name"</strong>      
    </p>
    <p>
      There should be one service instance registered for each configured synchronization group. Each instance should include this property with a unique name so that clients can get the synchronizer for the correct group.      
    </p>
    <p>
      <strong>void syncData(APSSyncDataEvent syncEvent) throws APSMessagingException</strong>      
    </p>
    <p>
      Synchronizes data.      
    </p>
    <p>
      <em>Parameters</em>      
    </p>
    <blockquote>
      <p>
        <em>syncEvent</em> - The sync event to send.         
      </p>
    </blockquote>
    <p>
      <em>Throws</em>      
    </p>
    <blockquote>
      <p>
        <em>APSMessagingException</em> - on failure.         
      </p>
    </blockquote>
    <p>
      <strong>void resync()</strong>      
    </p>
    <p>
      Triggers a resynchronization.      
    </p>
    <p>
      <strong>void resync(String key)</strong>      
    </p>
    <p>
      Triggers a resynchronization of the specified key.      
    </p>
    <p>
      <em>Parameters</em>      
    </p>
    <blockquote>
      <p>
        <em>key</em> - The key to resync.         
      </p>
    </blockquote>
    <p>
      <strong>void addSyncListener(Listener listener)</strong>      
    </p>
    <p>
      Adds a synchronization listener.      
    </p>
    <p>
      <em>Parameters</em>      
    </p>
    <blockquote>
      <p>
        <em>listener</em> - The listener to add.         
      </p>
    </blockquote>
    <p>
      <strong>void removeSyncListener(Listener listener)</strong>      
    </p>
    <p>
      Removes a synchronization listener.      
    </p>
    <p>
      <em>Parameters</em>      
    </p>
    <blockquote>
      <p>
        <em>listener</em> - The listener to remove.         
      </p>
    </blockquote>
    <p>
            
    </p>
    <p>
      <strong>void syncDataReceived(APSSyncEvent syncEvent)</strong>      
    </p>
    <p>
      Called to deliver a sync event. This can currently be one of:      
    </p>
    <ul>
      <li>
        <p>
          APSSyncDataEvent          
        </p>
      </li>
      <li>
        <p>
          APSReSyncEvent          
        </p>
      </li>
    </ul>
    <p>
      <em>Parameters</em>      
    </p>
    <blockquote>
      <p>
        <em>syncEvent</em> - The received sync event.         
      </p>
    </blockquote>
    <p>
      }      
    </p>
    <hr/>    <p>
                
    </p>
  </body>
</html>
