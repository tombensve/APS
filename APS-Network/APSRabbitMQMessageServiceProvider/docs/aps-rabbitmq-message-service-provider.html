<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="generated-by" content="MarkdownDoc"/>
    <link href="docs.css" type="text/css" rel="stylesheet"/>
  </head>
  <body>
    <H1>APS RabbitMQ Message Service Provider</H1>
    <p>
      This service provides an implementation of APSMessageService using <a href='http://www.rabbitmq.com/' title=''>RabbitMQ</a>.      
    </p>
    <H2>APSMessageService API</H2>
    <p>
      <a href='http://apidoc.natusoft.se/APS/se/natusoft/osgi/aps/api/net/messaging/service/APSMessageService.html' title=''>Javadoc</a>      
    </p>
    <p>
      public <em>interface</em> <strong>APSClusterService </strong>   [se.natusoft.osgi.aps.api.net.messaging.service] {      
    </p>
    <p>
      This service defines a synchronized cluster.      
    </p>
    <p>
            
    </p>
    <p>
            
    </p>
    <p>
            
    </p>
    <p>
      <strong>void clusterUpdated(String key, APSBox value)</strong>      
    </p>
    <p>
      Receives an updated value.      
    </p>
    <p>
      <em>Parameters</em>      
    </p>
    <blockquote>
      <p>
        <em>key</em> - The key of the updated value.         
      </p>
    </blockquote>
    <blockquote>
      <p>
        <em>value</em> - The actual value.         
      </p>
    </blockquote>
    <p>
      <strong>void update(String key, APSBox value)</strong>      
    </p>
    <p>
      Updates a keyed value to the cluster.      
    </p>
    <p>
      <em>Parameters</em>      
    </p>
    <blockquote>
      <p>
        <em>key</em> - This uniquely specifies what value this is. How it is used is upp tp the actual cluster using it.         
      </p>
    </blockquote>
    <blockquote>
      <p>
        <em>value</em> - The modified value to update.         
      </p>
    </blockquote>
    <p>
      <strong>void addUpdateListener(UpdateListener updateListener)</strong>      
    </p>
    <p>
      Adds an update listener.      
    </p>
    <p>
      <em>Parameters</em>      
    </p>
    <blockquote>
      <p>
        <em>updateListener</em> - The update listener to add.         
      </p>
    </blockquote>
    <p>
      <strong>void removeUpdateListener(UpdateListener updateListener)</strong>      
    </p>
    <p>
      Removes an update listener.      
    </p>
    <p>
      <em>Parameters</em>      
    </p>
    <blockquote>
      <p>
        <em>updateListener</em> - The listener to remove.         
      </p>
    </blockquote>
    <p>
      <strong>APSBox getNamedObject(String name)</strong>      
    </p>
    <p>
      Gets named cluster-wide object. If it does not exist it will be created.      
    </p>
    <p>
      <em>Parameters</em>      
    </p>
    <blockquote>
      <p>
        <em>name</em> - The name of the cluster object to get.         
      </p>
    </blockquote>
    <p>
      <strong>List&lt;APSBox&gt; getNamedList(String name)</strong>      
    </p>
    <p>
      Gets a cluster-wide named list. If it does not exist it will be created.      
    </p>
    <p>
      <em>Parameters</em>      
    </p>
    <blockquote>
      <p>
        <em>name</em> - The name of the list to get.         
      </p>
    </blockquote>
    <p>
      <strong>Map&lt;String, APSBox&gt; getNamedMap(String name)</strong>      
    </p>
    <p>
      Gets a cluster-wide named Map. If it does not exist, it will be created.      
    </p>
    <p>
      Do note that this is mostly a convenience. Implementations can (and most will) use the name as a prefix to the map key and then call getNamedObject(expandedKey).      
    </p>
    <p>
      <em>Parameters</em>      
    </p>
    <blockquote>
      <p>
        <em>name</em> - The name of the map to get.         
      </p>
    </blockquote>
    <p>
      <strong>void withLock(String nameToLock, Future future)</strong>      
    </p>
    <p>
      Locks a specific entry in the cluster or all entries starting with the specified 'nameToLock'. When a lock is acquired the future is executed and when done the lock is released.      
    </p>
    <p>
      Any other client who tries to update the locked name(s) during the lock period without acquiring their own lock will get an exception.      
    </p>
    <p>
      <em>Parameters</em>      
    </p>
    <blockquote>
      <p>
        <em>nameToLock</em> - The name of the value(s) to lock.         
      </p>
    </blockquote>
    <blockquote>
      <p>
        <em>future</em> - A Future to execute when the lock is acquired.         
      </p>
    </blockquote>
    <p>
            
    </p>
    <p>
      <strong>List&lt;UpdateListener&gt; listeners = Collections.synchronizedList(new LinkedList&lt;UpdateListener&gt;())</strong>      
    </p>
    <p>
       The listeners.      
    </p>
    <p>
            
    </p>
    <p>
            
    </p>
    <p>
      <strong>protected void updateListeners(String key, APSBox value)</strong>      
    </p>
    <p>
      Updates all listeners.      
    </p>
    <p>
      <em>Parameters</em>      
    </p>
    <blockquote>
      <p>
        <em>key</em> - The key of the update.         
      </p>
    </blockquote>
    <blockquote>
      <p>
        <em>value</em> - The value of the update.         
      </p>
    </blockquote>
    <p>
      <strong>protected List&lt;UpdateListener&gt; getListeners()</strong>      
    </p>
    <p>
      Returns the listeners.      
    </p>
    <p>
      }      
    </p>
    <hr/>    <p>
                
    </p>
    <p>
      public <em>interface</em> <strong>APSMessageListener </strong>   [se.natusoft.osgi.aps.api.net.messaging.service] {      
    </p>
    <p>
      Listener for APSMessage.      
    </p>
    <p>
      <strong>void messageReceived(byte[] message)</strong>      
    </p>
    <p>
      This is called when a message is received.      
    </p>
    <p>
      <em>Parameters</em>      
    </p>
    <blockquote>
      <p>
        <em>message</em> - The received message.         
      </p>
    </blockquote>
    <p>
      }      
    </p>
    <hr/>    <p>
                
    </p>
    <p>
      public <em>interface</em> <strong>APSMessageService </strong>   [se.natusoft.osgi.aps.api.net.messaging.service] {      
    </p>
    <p>
      This defines a simple message service. Can be implemented by using a message bus like RabbitMQ, Active MQ, etc or just a simple tcpip server or whatever.      
    </p>
    <p>
      Since the actual members are outside of this service API, it doesn't really know who they are and doesn't care, all members are defined by configuration.      
    </p>
    <p>
            
    </p>
    <p>
            
    </p>
    <p>
      <strong>void addMessageListener(APSMessageListener listener)</strong>      
    </p>
    <p>
      Adds a listener for types.      
    </p>
    <p>
      <em>Parameters</em>      
    </p>
    <blockquote>
      <p>
        <em>listener</em> - The listener to add.         
      </p>
    </blockquote>
    <p>
      <strong>void removeMessageListener(APSMessageListener listener)</strong>      
    </p>
    <p>
      Removes a messaging listener.      
    </p>
    <p>
      <em>Parameters</em>      
    </p>
    <blockquote>
      <p>
        <em>listener</em> - The listener to remove.         
      </p>
    </blockquote>
    <p>
      <strong>void sendMessage(byte[] message) throws APSMessagingException</strong>      
    </p>
    <p>
      Sends a message.      
    </p>
    <p>
      <em>Parameters</em>      
    </p>
    <blockquote>
      <p>
        <em>message</em> - The message to send.         
      </p>
    </blockquote>
    <p>
      <em>Throws</em>      
    </p>
    <blockquote>
      <p>
        <em>APSMessagingException</em> - on failure.         
      </p>
    </blockquote>
    <p>
      public <em>static</em> <em>abstract</em> <em>class</em> <strong>AbstractMessageServiceProvider </strong> implements  APSMessageService    [se.natusoft.osgi.aps.api.net.messaging.service] {      
    </p>
    <p>
      Provides an abstract implementation of the APSMessageService interface.      
    </p>
    <p>
            
    </p>
    <p>
            
    </p>
    <p>
            
    </p>
    <p>
      <strong>protected void sendToListeners(byte[] message)</strong>      
    </p>
    <p>
      Sends a message to the registered listeners.      
    </p>
    <p>
      <em>Parameters</em>      
    </p>
    <blockquote>
      <p>
        <em>message</em> - The message to send.         
      </p>
    </blockquote>
    <p>
      <strong>protected List&lt;APSMessageListener&gt; getMessageListeners()</strong>      
    </p>
    <p>
      Returns the message listeners.      
    </p>
    <p>
      }      
    </p>
    <hr/>    <p>
                
    </p>
  </body>
</html>
